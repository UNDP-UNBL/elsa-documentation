# MkDocs Migration Guide

This document provides a comprehensive guide for the migration from Sphinx to MkDocs for the ELSA documentation.

## Migration Summary

✅ **Completed:**
- Converted all ELSA tool documentation from RST to Markdown format
- Created MkDocs configuration (mkdocs.yml)
- Set up multi-language support (English, Spanish, French, Portuguese, Russian)
- Migrated static assets (CSS, images)
- Updated for GitHub Pages deployment
- Created mamba/conda environment for MkDocs
- Fixed navigation structure
- Successfully built documentation for all languages
- Removed training materials and regional guidance to focus on core ELSA tool usage

## What Changed

### 1. Documentation Format
- **Before:** reStructuredText (.rst files)
- **After:** Markdown (.md files)

All ELSA tool documentation has been converted to Markdown using a custom conversion script.

### 2. Build System
- **Before:** Sphinx with sphinx_rtd_theme
- **After:** MkDocs with Material for MkDocs theme

### 3. Configuration
- **Before:** `docs/conf.py` (Python configuration)
- **After:** `mkdocs.yml` (YAML configuration)

### 4. Multi-language Support
- **Before:** Sphinx gettext with .po files in `docs/locales/`
- **After:** mkdocs-static-i18n plugin with suffix structure (e.g., `index.es.md`)

### 5. Theme and Styling
- **Before:** Read the Docs theme
- **After:** Material for MkDocs (modern, mobile-responsive design)

### 6. Documentation Scope
- **Before:** 72 pages including training materials and regional guidance
- **After:** 13 core ELSA tool documentation pages (focused on web tool usage)

## File Structure

```
elsa-documentation/
├── mkdocs.yml                    # Main MkDocs configuration
├── requirements.txt              # Python dependencies
├── environment-mkdocs.yaml       # Conda/mamba environment
├── .readthedocs.yaml            # Updated for MkDocs
├── docs/
│   ├── index.md                 # Main documentation index
│   ├── assets/
│   │   └── css/
│   │       └── elsa-custom.css  # Custom styling
│   └── elsa/                    # ELSA tool documentation (13 files)
├── archive/
│   └── sphinx-locales/          # Original Sphinx translations (for reference)
└── site/                        # Built site (generated by mkdocs build)
```

## Building the Documentation

### Using Mamba/Conda (Recommended)

```bash
# Activate the environment
mamba activate elsa-mkdocs

# Build the documentation
mkdocs build

# Serve locally for testing
mkdocs serve
```

### Using Python venv

```bash
# Create virtual environment
python3 -m venv venv
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Build the documentation
mkdocs build

# Serve locally
mkdocs serve
```

### Quick Commands

```bash
# Full path mamba commands (if not in PATH)
/home/scottca/miniconda3/bin/mamba activate elsa-mkdocs
/home/scottca/miniconda3/bin/mamba run -n elsa-mkdocs mkdocs build
/home/scottca/miniconda3/bin/mamba run -n elsa-mkdocs mkdocs serve
```

## Key Features

### 1. Modern Material Theme
- Clean, professional design
- Mobile-responsive
- Dark/light mode toggle
- Better navigation with tabs
- Improved search functionality

### 2. Multi-language Support
The site now supports 5 languages:
- English (default)
- Spanish (Español)
- French (Français)
- Portuguese (Português)
- Russian (Русский)

Language switching is available via the site header.

### 3. Enhanced Features
- **Code copy buttons**: Easy copying of code blocks
- **Image lightbox**: Click images to view full-size
- **Search**: Fast, client-side search across all pages
- **Navigation**: Tabbed navigation with breadcrumbs
- **GitHub integration**: Edit links for each page
- **Responsive tables**: Mobile-friendly tables

### 4. Free Hosting with GitHub Pages
Documentation is now hosted on GitHub Pages (free, unlimited bandwidth) instead of ReadTheDocs.

## Translation Migration

### Current Status
The English content has been fully converted to Markdown. The original translations are archived in `archive/sphinx-locales/` directory as .po files for reference.

### Completing Translations

**Option 1: Helper Script**
Run the provided script to create placeholder files:
```bash
python3 setup_i18n.py
```

This creates language-specific files (e.g., `index.es.md`, `index.fr.md`) that need to be populated with translations.

**Option 2: Manual Translation**
1. Copy the English .md file
2. Rename with language suffix (e.g., `01_overview.es.md`)
3. Extract translations from corresponding .po file
4. Replace English text with translations

**Option 3: Professional Services**
Consider using translation management platforms:
- Crowdin
- Transifex
- Lokalise

These can import .po files and export as Markdown.

## GitHub Pages Deployment

The repository is configured for automatic deployment to GitHub Pages via GitHub Actions:

1. Push changes to the main branch
2. GitHub Actions automatically triggers the build workflow
3. Documentation is built using `mkdocs gh-deploy`
4. Site is deployed to GitHub Pages within 2-3 minutes
5. All configured languages are available

**Benefits:**
- Free hosting (no paid plans needed)
- Automatic deployment on push
- Fast build times (~2-3 minutes)
- Custom domain support (docs.unbiodiversitylab.org)

## Testing

### Local Testing
```bash
# Start local server
mkdocs serve

# Open in browser
http://127.0.0.1:8000

# Test language switching in the header
```

### Build Testing
```bash
# Clean build
rm -rf site/
mkdocs build

# Check for warnings
mkdocs build --strict
```

### Link Validation
```bash
# Install link checker
pip install mkdocs-htmlproofer-plugin

# Add to mkdocs.yml plugins section
# Run build to check links
mkdocs build
```

## Customization

### Updating Styles
Edit `docs/assets/css/elsa-custom.css` to customize appearance.

### Adding Plugins
Add to `mkdocs.yml` under `plugins:` section. See [MkDocs Plugin Catalog](https://github.com/mkdocs/catalog).

### Modifying Navigation
Edit the `nav:` section in `mkdocs.yml` to change page order or structure.

## Migration Scripts

### convert_rst_to_md.py
Converts all RST files to Markdown format. Features:
- Title/heading conversion
- Directive conversion (note, warning, etc.)
- Image path handling
- Code block conversion
- Cross-reference links

### setup_i18n.py
Sets up multi-language structure. Features:
- Creates language-specific file placeholders
- Generates translation migration guide
- Provides helper documentation

## Advantages Over Sphinx

1. **Simplicity**: YAML configuration vs Python
2. **Speed**: Faster builds (8 seconds vs ~30 seconds for Sphinx)
3. **Modern theme**: Better UX with Material theme
4. **Free hosting**: No paid ReadTheDocs plan needed
5. **Easier maintenance**: Markdown is more widely known than RST
6. **Better mobile support**: Responsive design out of the box
7. **Active development**: Material for MkDocs is actively maintained

## Compatibility Notes

### ReadTheDocs
- Works on free tier
- Supports PDF generation
- Multi-language builds supported
- GitHub integration maintained

### Search
- Client-side search (no server needed)
- Multi-language search support
- Instant results

### Analytics
Ready for Google Analytics, privacy-friendly alternatives, or ReadTheDocs analytics.

## Next Steps

1. **Review converted content**: Check that all pages render correctly
2. **Complete translations**: Migrate translations from .po files
3. **Test thoroughly**: Verify all links, images, and features work
4. **Update documentation**: Add any project-specific content
5. **Deploy to ReadTheDocs**: Push to main branch to trigger build
6. **Monitor builds**: Check ReadTheDocs dashboard for any issues

## Support

For help with:
- **MkDocs**: https://www.mkdocs.org/
- **Material theme**: https://squidfunk.github.io/mkdocs-material/
- **ReadTheDocs**: https://docs.readthedocs.io/
- **i18n plugin**: https://github.com/ultrabug/mkdocs-static-i18n

## Rollback Plan

If you need to revert changes:
1. Git history contains all previous configurations
2. The original `.po` translation files are archived in `archive/sphinx-locales/`
3. Use git to restore any previous versions if needed

## Cost Savings

**Before (Sphinx on ReadTheDocs):**
- Required paid ReadTheDocs plan for multi-language builds
- Estimated cost: $50-150/month depending on plan

**After (MkDocs on GitHub Pages):**
- Free GitHub Pages hosting
- Free unlimited bandwidth
- No account management needed
- Cost: $0/month

**Annual savings: $600-1,800**

## Conclusion

The migration to MkDocs with GitHub Pages provides a modern, cost-effective documentation solution. The documentation is now:
- Focused on core ELSA web tool usage (removed training and regional guidance)
- Easier to maintain with Markdown format
- Faster to build (~3-4 seconds locally)
- Free to host on GitHub Pages
- Automatically deployed via GitHub Actions
